openapi: 3.0.3
info:
  title: Localization Contract Delta (English + Chinese)
  version: 0.1.0
  description: |
    This is a delta-style contract describing the API changes required by
    the 004-localization feature. The canonical OpenAPI remains generated by
    the backend at /api/v1/openapi.json.

paths:
  /api/v1/users/me:
    get:
      summary: Read current user
      responses:
        '200':
          description: Current user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPublic'
    patch:
      summary: Update current user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UserUpdateMe'
      responses:
        '200':
          description: Updated user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserPublic'

components:
  schemas:
    SupportedLocale:
      type: string
      enum: [en, zh]
      description: |
        Stable UI language identifier used across backend and frontend i18n.
        For this feature, only `en` and `zh` are supported. Future locales may be
        added as additional values.

    UserUpdateMe:
      type: object
      additionalProperties: false
      properties:
        full_name:
          type: string
          nullable: true
        email:
          type: string
          format: email
          nullable: true
        locale:
          $ref: '#/components/schemas/SupportedLocale'
      description: |
        Update fields for the current user. `locale` is optional; if omitted,
        the account preference is unchanged.
        `locale` values are stable language identifiers (compatible with i18n
        libraries like i18next). The backend validates allowed values.

    UserPublic:
      type: object
      additionalProperties: false
      required: [id, email, is_active, is_superuser]
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
          format: email
        is_active:
          type: boolean
        is_superuser:
          type: boolean
        full_name:
          type: string
          nullable: true
        locale:
          $ref: '#/components/schemas/SupportedLocale'
      description: Public user shape including optional locale.
